<div class="row" (bbTrackNavigation)="trackNavigation($event)">
  <div class="bb-card col-lg-6">
    <div class="bb-card__header">
      <h1
        class="bb-card__title"
        *ngIf="title !== ''"
        data-role="transactions-view__title"
      >
        {{ title }}
      </h1>
    </div>

    <div class="bb-card__body">
      <!-- Account Selector -->
      <div class="bb-block bb-block--md">
        <bb-account-selector-ui
          data-role="transactions-view__account-selector"
          [items]="accounts$ | async"
          [markFirst]="false"
          [closeOnSelect]="true"
          [filterItems]="true"
          [dropdownPosition]="'bottom'"
          [multiple]="false"
          placeholder="Select account"
          i18n-placeholder="
            Account selector placeholder - 'Select account'|This string is used
            as the placeholder for the account selector dropdown. It is
            presented to the user when no account is selected.
            @@transactions.account-selector.placeholder"
          (change)="onAccountSelected($any($event))"
        >
        </bb-account-selector-ui>
      </div>

      <div class="bb-block bb-block--md">
        <bb-text-filter
          [text]="searchQuery$ | async"
          (textChange)="search($event)"
        ></bb-text-filter>
      </div>

      <div
        class="bb-block bb-block--md"
        *ngIf="accountName$ | async as accountName"
      >
        <span
          i18n="
            Label for filtered by - 'filtered by:'|This string is used as the
            label for the filter section in the transactions view. It is
            presented to the user to indicate the criteria by which the
            transactions are filtered. This label is located in the transactions
            view component.@@transactions.filters.label"
          >filtered by:</span
        >

        <bb-badge-ui
          [text]="accountName + ' âœ•'"
          title="Remove account filter"
          i18n-title="
            Remove account label for Account Badge - 'Remove account
            filter'|This string is used as the title for the remove account
            filter button in the transactions view. It is presented to the user
            as a tooltip when they hover over the button to remove the account
            filter. This title is located in the transactions view
            component.@@transactions.account-filter.remove"
          class="filters-badge"
          color="success"
          routerLink="/transactions"
          queryParamsHandling="merge"
          [queryParams]="{ account: null }"
        >
        </bb-badge-ui>
      </div>

      <ng-container *ngIf="transactions$ | async as items; else loading">
        <!-- Empty State -->
        <div
          *ngIf="items.length === 0"
          data-role="transactions-view__empty-state"
          class="bb-block bb-block--lg"
        >
          <bb-empty-state-ui
            title="No transactions"
            i18n-title="
              Transactions empty state title - 'No transactions'|This string is
              used as the title for the empty state when no transactions are
              available for the selected account.
              @@transactions.empty-state.title"
            subtitle="There are no transactions for this account."
            i18n-subtitle="
              Transactions empty state subtitle - 'There are no transactions for
              this account.'|This string is used as the subtitle for the empty
              state when no transactions are available.
              @@transactions.empty-state.subtitle"
          >
          </bb-empty-state-ui>
        </div>

        <!-- Transactions List -->
        <ul *ngIf="items.length > 0" class="bb-list">
          <li
            *ngFor="let item of items | filterTransactions : filter"
            class="bb-list__item"
            data-role="transactions-view__item-container"
          >
            <a class="list-link" [routerLink]="['./', item.id]">
              <bb-transaction-item
                [transaction]="item"
                [categoryName]="item.category"
              ></bb-transaction-item>
            </a>
          </li>
        </ul>
      </ng-container>
    </div>
  </div>
</div>

<ng-template #loading>
  <div data-role="transactions-view__loading-state-container">
    <bb-loading-indicator-ui loaderSize="lg"></bb-loading-indicator-ui>
  </div>
</ng-template>

<router-outlet></router-outlet>
